I"<p>In March 2017, a group of influenza forecasters who have participated in the <a href="https://predict.phiresearchlab.org">CDC FluSight challenge</a> in past seasons established the FluSight Network, a multi-institution and multi-disciplinary consortium of forecasting teams. This group worked throughout 2017 to create a public, real-time collaborative ensemble forecasting model that provides <a href="http://flusightnetwork.io/">updated forecasts of influenza in the US each week</a>.</p>

<p><a href="http://flusightnetwork.io"><img class="img-responsive" width="700" src="/images/blog/collaborative-ensemble-overview.png" /></a></p>

<!--more-->

<h3 id="background">Background</h3>
<p>Every flu season since 2013/2014, the CDC has organized a challenge where, each week from early November through mid April, teams submit forecasts about the flu season in the US.
For every week in a season, each submission contains forecasts for seven targets of public health interest specified by the CDC for each of the 11 HHS regions. The region-level targets are: the fraction of doctor’s visits where due to influenza-like-illness in each of the next four weeks of the season, the week of season onset, the week in which the peak wILI occurs, and the level of the peak wILI.
The forecasts themselves are text files containing, in a specified format, data that encode predictive distribution for these targets.</p>

<p>Throughout this project, the central question has been <strong>can we provide better information to decision makers by combining forecasting models</strong>, and specifically by using past performance of the component models to inform the ensemble approach. All previous participants in FluSight challenges were invited to join the FluSight Network. Four groups decided to participate and contributed <a href="https://github.com/FluSightNetwork/cdc-flusight-ensemble/tree/master/model-forecasts">21 models in total</a> using a diverse array of methodologies, including kernel conditional density estimation, Bayesian state-space models, simple seasonal models, auto-regressive models for time-series, and susceptible-infectious-recovered-susceptible compartmental models, to name just a few.</p>

<table>
  <thead>
    <tr>
      <th>Institution</th>
      <th>No. of models</th>
      <th>Team leaders</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Delphi team at Carnegie Mellon</td>
      <td>9</td>
      <td>Logan Brooks, Roni Rosenfeld</td>
    </tr>
    <tr>
      <td>Columbia University</td>
      <td>7</td>
      <td>Teresa Yamana, Sasikiran Kandula, Jeff Shaman</td>
    </tr>
    <tr>
      <td>Los Alamos National Laboratory</td>
      <td>1</td>
      <td>Dave Osthus</td>
    </tr>
    <tr>
      <td>Reich Lab at UMass-Amherst</td>
      <td>4</td>
      <td>Nicholas Reich, Abhinav Tushar, Evan Ray</td>
    </tr>
  </tbody>
</table>

<p>Prior to the start of the 2017/2018 influenza season in the US (first submissions were due on November 6), we assembled these 21 distinct forecasting models for influenza, each with forecasts from the last seven influenza seasons in the US. (To the extent possible, these forecasts were only allowed to use data available at the time the forecasts were made.)</p>

<p>Subsequently, we conducted a cross-validation study to compare five different methods for combining these models into a single ensemble forecast. Specifically, this was done by leaving one season out at a time, fitting each ensemble model based on the remaining seasons’ data, and generating ensemble forecasts for each week of the left-out season. Then, we evaluated and compared the performance of the ensemble models.</p>

<h3 id="ensemble-specifications">Ensemble specifications</h3>
<p>All of our ensemble models are built by taking weighted averages of the component models. We examined the performance of five different possible ensemble specifications (see table below). The “equal weights” model takes a simple average of all of the models, with no consideration of past performance. The other four approaches estimated weights for models based on past performance, using the degenerate EM algorithm.</p>

<table>
  <thead>
    <tr>
      <th>Model</th>
      <th>No. of weights</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Equal weights (EW)</td>
      <td>1</td>
      <td>Every model gets same weight.</td>
    </tr>
    <tr>
      <td>Constant weights (CW)</td>
      <td>21</td>
      <td>Every model gets a single weight, not necessarily the same.</td>
    </tr>
    <tr>
      <td>Target-type-based weights (TTW)</td>
      <td>42</td>
      <td>Two sets of weights, one for seasonal targets and one for weekly wILI targets.</td>
    </tr>
    <tr>
      <td>Target-based weights (TW)</td>
      <td>147</td>
      <td>Seven sets of weights, one for each target separately.</td>
    </tr>
    <tr>
      <td>Target-and-region-based weights (TRW)</td>
      <td>1,617</td>
      <td>Target-based weights estimated separately for each region.</td>
    </tr>
  </tbody>
</table>

<h3 id="forecast-evaluation">Forecast Evaluation</h3>
<p>We measured performance by computing the average score across all targets and all relevant weeks in the last seven seasons. (Including only “relevant weeks” means, e.g., that for evaluating season onset we exclude weeks after the onset has clearly occured, because at this point, the forecasts are no longer informative.) The ensemble models generally showed better average scores than any of the component models, and there was little difference between the CW, TTW, TW, and TRW models.</p>

<p>For submitting in real-time in 2017-2018, we selected the ensemble model that achieved the best overall score in the cross-validation experiment over the last seven seasons. This was the target-type-based model (TTW) that assigned one set of weights to each component model for the weekly incidence targets and another set of weights for the seasonal targets (onset timing, peak timing, and peak incidence).</p>

<p><img class="img-responsive" width="700" src="/images/blog/collaborative-ensemble-comparison.jpeg" /></p>

:ET